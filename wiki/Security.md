# Security

Multi-Agent Tester implements enterprise-grade security with client-side encryption and zero server storage. This document details the security architecture and best practices.

## Security Architecture

### Core Security Principles

1. **Client-Side Only** - All data stays in your browser
2. **Zero Server Storage** - No server sees or stores your data
3. **End-to-End Encryption** - AES-256-GCM encryption at rest
4. **User Control** - Complete data isolation and control

### Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         User Interface                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Application Logic (React)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Encryption Layer (Web Crypto API)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Encrypted Storage (Spark KV)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Browser Storage (IndexedDB)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Client-Side Encryption

### Encryption Specification

**Algorithm**: AES-256-GCM (Advanced Encryption Standard, Galois/Counter Mode)

**Key Features:**
- 256-bit key length
- Authenticated encryption (AEAD)
- Galois/Counter Mode for performance
- Built-in integrity verification

**Key Derivation**: PBKDF2 (Password-Based Key Derivation Function 2)

**Parameters:**
- Hash function: SHA-256
- Iterations: 100,000
- Salt: Random 16-byte value
- Key length: 256 bits

### What Gets Encrypted

All sensitive data is encrypted before storage:

âœ… **Token Configurations**
- Client IDs and secrets
- Usernames and passwords
- Token endpoint URLs

âœ… **Authentication Tokens**
- Access tokens
- Refresh tokens
- Token metadata

âœ… **Agent Configurations**
- Endpoint URLs
- Protocol settings
- Custom headers

âœ… **Conversation History**
- All messages (user and agent)
- Timestamps and metadata
- Response metrics

âœ… **User Preferences**
- Custom theme settings
- Keyboard shortcuts
- Privacy settings

### How Encryption Works

#### Encryption Process

```
1. User provides encryption password
2. Generate random salt (16 bytes)
3. Derive key using PBKDF2
   - Password + Salt
   - 100,000 iterations
   - SHA-256 hash
   - Output: 256-bit key
4. Generate random IV (12 bytes)
5. Encrypt data with AES-256-GCM
   - Key + IV + Data
   - Output: Ciphertext + Auth Tag
6. Store: Salt + IV + Ciphertext + Tag
```

#### Decryption Process

```
1. User provides encryption password
2. Retrieve stored: Salt + IV + Ciphertext + Tag
3. Derive key using PBKDF2
   - Password + Salt
   - Same parameters as encryption
4. Decrypt with AES-256-GCM
   - Key + IV + Ciphertext + Tag
   - Verification of Auth Tag
   - Output: Original data
```

### Encryption Best Practices

#### Password Strength

Use strong encryption passwords:

âœ… **Good Passwords:**
- At least 16 characters
- Mix of letters, numbers, symbols
- Unique to this application
- Generated by password manager

âŒ **Avoid:**
- Short passwords (< 12 characters)
- Common words or phrases
- Reused passwords
- Personal information

#### Password Management

- **Use a password manager** to store encryption passwords
- **Don't write down** encryption passwords
- **Don't share** encryption passwords
- **Remember the password** - cannot be recovered if forgotten

## Zero Server Storage

### What This Means

**Your data never leaves your browser:**

âœ… All storage is browser-based (IndexedDB)  
âœ… No data sent to external servers  
âœ… No server-side data storage  
âœ… No cloud synchronization  
âœ… No analytics or tracking  

**Communication model:**

```
Browser â†â†’ Agent API
   â†‘
   Only sends messages
   directly to agent endpoints
```

### Data Flow

```
User Input
    â†“
Browser Storage (Encrypted)
    â†“
Decrypt in memory
    â†“
Send to Agent API
    â†“
Receive response
    â†“
Store encrypted in browser
```

**No intermediate servers** - Direct browser-to-agent communication only.

## Storage Security

### Browser Storage Technologies

Multi-Agent Tester uses:

1. **IndexedDB** (via Spark KV)
   - Primary storage for all data
   - Encrypted at rest
   - Isolated per origin

2. **localStorage**
   - Theme preferences (non-sensitive)
   - UI state (non-sensitive)

3. **sessionStorage**
   - Temporary session data
   - Cleared on tab close

### Storage Isolation

**Per-User Isolation:**
- Data is scoped to browser profile
- No cross-user data access
- Complete user control

**Per-Origin Isolation:**
- Browser enforces same-origin policy
- No cross-site data access
- Protected by browser security

## Authentication Security

### OAuth2 Token Flow

```
1. User configures token endpoint
2. Application sends credentials
3. OAuth2 server returns token
4. Token stored encrypted in browser
5. Token used for agent API calls
```

**Security features:**
- Tokens stored encrypted
- Token expiration tracking
- Automatic refresh capability
- Configurable refresh limits

### Token Management

**Best Practices:**

1. **Test Credentials Only**
   - Never use production credentials
   - Create dedicated test accounts
   - Use separate OAuth clients for testing

2. **Token Rotation**
   - Enable auto-refresh for long sessions
   - Monitor expiration countdown
   - Set appropriate refresh limits

3. **Token Storage**
   - Always encrypt token configurations
   - Use strong encryption passwords
   - Clear tokens after testing

### Bearer Token Security

Tokens are sent in HTTP headers:

```http
Authorization: Bearer {access_token}
```

**Protection:**
- HTTPS required (enforce in production)
- Short-lived tokens recommended
- Token refresh for long sessions
- Secure token storage (encrypted)

## Data Export Security

### Export Format

Exported data is **not encrypted**:
- JSON plaintext format
- Contains all sensitive data
- Includes credentials and tokens

âš ï¸ **Handle exported files securely!**

### Export Best Practices

1. **Secure Storage**
   - Store in encrypted drive
   - Use file encryption (e.g., GPG)
   - Delete after use

2. **Secure Transfer**
   - Use encrypted channels
   - Don't email unencrypted exports
   - Use secure file sharing

3. **Clean Up**
   - Delete exports when done
   - Empty trash/recycle bin
   - Overwrite if needed

### Import Security

When importing configurations:
- Review data before import
- Verify source authenticity
- Re-encrypt after import
- Audit imported settings

## Threat Model

### Protected Against

âœ… **Passive Attacks:**
- Storage inspection (data encrypted)
- Browser history analysis (no sensitive URLs)
- Cache inspection (no sensitive cache)

âœ… **Active Attacks:**
- XSS (React built-in protection)
- CSRF (no server state)
- SQL Injection (no database)

âœ… **Physical Access:**
- Device theft (data encrypted)
- Shoulder surfing (password masking)
- Screen recording (sensitive fields masked)

### Not Protected Against

âŒ **Malware on Device:**
- Keyloggers can capture passwords
- Screen capture malware
- Memory dumping attacks

âŒ **Compromised Browser:**
- Malicious extensions
- Browser vulnerabilities
- Debugger access

âŒ **Phishing:**
- Fake agent endpoints
- Credential theft
- Social engineering

### Security Assumptions

This security model assumes:
1. Trusted device
2. Secure browser
3. No malware
4. Secure network (HTTPS)
5. User following best practices

## Security Best Practices

### For Users

#### 1. Use Test Credentials Only

âš ï¸ **Never use production credentials**

- Create dedicated test accounts
- Use test environments only
- Separate credentials per environment
- Rotate test credentials regularly

#### 2. Enable Encryption

âœ… Always encrypt:
- Token configurations
- Sensitive settings
- All stored data

Use strong encryption passwords:
- Minimum 16 characters
- Password manager recommended
- Unique to this application

#### 3. Clear Data After Testing

After each testing session:
1. Export needed conversations
2. Clear sensitive data via Security & Privacy
3. Sign out of test accounts
4. Close browser tab

#### 4. Lock Your Device

Physical security matters:
- Lock screen when away
- Use device encryption
- Set auto-lock timeout
- Secure physical access

#### 5. Use Browser Profiles

Isolate different projects:
- Create separate browser profiles
- One profile per project
- No credential mixing
- Easy data separation

#### 6. Monitor Token Access

Track token usage:
- Watch expiration countdown
- Monitor refresh count
- Check API call patterns
- Alert on suspicious activity

### For Administrators

#### 1. Network Security

- Enforce HTTPS for all endpoints
- Use TLS 1.3 or higher
- Implement certificate pinning
- Monitor network traffic

#### 2. OAuth2 Configuration

- Short-lived access tokens (15-60 minutes)
- Secure refresh token storage
- Token rotation policy
- Revocation capability

#### 3. Agent API Security

- Validate Bearer tokens
- Rate limiting
- Request logging
- Anomaly detection

#### 4. Security Monitoring

- Audit API access logs
- Monitor for unusual patterns
- Alert on suspicious activity
- Regular security reviews

## Compliance Considerations

### Data Privacy

Multi-Agent Tester is designed for privacy:
- No data collection
- No analytics or tracking
- No third-party services
- Client-side only

### Regulatory Compliance

Consider these frameworks:
- **GDPR**: No personal data collection
- **HIPAA**: Not for PHI storage
- **PCI DSS**: Not for payment card data
- **SOC 2**: Client-side security only

âš ï¸ **Important**: Ensure your organization's policies allow:
- Client-side credential storage
- Browser-based encryption
- Test credential usage

## Security Auditing

### Self-Audit Checklist

âœ… **Configuration:**
- [ ] All configurations encrypted
- [ ] Strong encryption passwords
- [ ] Test credentials only
- [ ] HTTPS endpoints

âœ… **Usage:**
- [ ] Data cleared after sessions
- [ ] Exports handled securely
- [ ] Device locked when away
- [ ] Browser profile isolated

âœ… **Monitoring:**
- [ ] Token expiration tracked
- [ ] API calls monitored
- [ ] No suspicious activity
- [ ] Regular security reviews

### Security Incident Response

If you suspect a security issue:

1. **Immediate Actions:**
   - Stop using the application
   - Clear all data via Security & Privacy
   - Change test credentials
   - Close browser completely

2. **Investigation:**
   - Review recent activity
   - Check API logs
   - Verify endpoints
   - Scan for malware

3. **Reporting:**
   - [Report security issues](https://github.com/chovancova/conversation-agent-t/security)
   - Do not disclose publicly
   - Provide details privately
   - Allow time for response

## Security Limitations

### Known Limitations

1. **Client-Side Only**
   - Relies on browser security
   - No server-side validation
   - Vulnerable to local attacks

2. **Encryption at Rest Only**
   - No encryption in transit (handled by HTTPS)
   - Decrypted in memory during use
   - Memory can be accessed by malware

3. **No Multi-Device Sync**
   - Data stays on one device
   - No cloud backup
   - Loss if browser data cleared

4. **Testing Tool Only**
   - Not for production use
   - Test credentials only
   - Limited security features

### When NOT to Use

âŒ **Do not use for:**
- Production credential management
- Storing sensitive production data
- Processing real customer data
- Handling payment information
- Managing production secrets

## Additional Resources

- **[OWASP Top 10](https://owasp.org/www-project-top-ten/)** - Web security risks
- **[Web Crypto API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API)** - Browser cryptography
- **[OAuth 2.0 Security](https://oauth.net/2/)** - OAuth security best practices

## Questions?

For security questions or concerns:
- ğŸ“– Review this security documentation
- ğŸ”’ Check repository [SECURITY.md](https://github.com/chovancova/conversation-agent-t/blob/main/SECURITY.md)
- ğŸ› [Report security issues](https://github.com/chovancova/conversation-agent-t/security) privately

---

**Previous**: [[Configuration|Configuration]]  
**Next**: [[Features|Features]]
